---
title: "Use buildTM() to Begin Writing Your Report"
author: Emily Markowitz (Emily.Markowitz AT NOAA.gov / EmilyMarkowitz-NOAA)
date: "`r format(Sys.Date(), format='%B %d %Y') `"
output: 
  html_document:
    standalone: true
    smart: true
    normalize: true
    toc: true
    highlight: tango
    self-contained: true
    theme: cerulean
  pdf_document:
    toc: true
    highlight: tango
vignette: >
  %\VignetteIndexEntry{A_use-buildTM}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(message = FALSE, echo = TRUE, warning = FALSE, 
  collapse = TRUE,
  comment = "#>"
)

TF<-FALSE
```

# Load Package

```{r setup}
PKG <- c(# devtools::install_github("emilymarkowitz-NOAA/NMFSReports", force = TRUE)
         "NMFSReports",
         
         # Data Managment
         "tidyverse",
         "here",
         
         # Visuals
         "nmfspalette"
)

for (p in PKG) {
  if(!require(p,character.only = TRUE)) {  
    install.packages(p, repos = "http://cran.us.r-project.org")
    require(p,character.only = TRUE)}
}
```

# Create initial structure of report

Do everyone here a favor and create a new r project or at least set up a working directory (`setwd()`). There will be a lot of file management here...

To build your intitial architecture for your new NOAA Tech Memo or Report, simply run the below script: 

## sections

Let's first think about what you want/need your Tech Memo to look like. For my purposes, I'll assume that you need the below sections:

```{r}
  # list the sections (that you will have different rmd scripts for) in order and with no spaces
sections <- c("frontmatter", # This is a specific template that matches the NOAA Template
               "abstract", # This, and all others unless otherwise mentioned, come from the same plain-slate document but are appropriately named and linked up in the 'run' file. 
               "introduction", 
               "methods", 
               "results", 
               "discussion", 
               "workscited", 
               "workscitedR", # This is a specific template that will document all of the R packages you used to create this report. I'm biased, but please give credit where credit is due!
               "presentations" # This is a specific template that matches the NOAA Template
              ) 
```

## support_scripts

And to make sure we nice and neatly compartemantalize our work, I'm going to create the below supporting .R files that I will source into my 'run' file:

```{r}
support_scripts <-
    c(# note a 'run' file is automatically created. Think of this as the spine of your document. 
      "functions", # where I will save all report-specific functions
      "dataDL", # Where we will download the data (e.g., from Oracle or an API). You may only want to run this every so often or regularly, up to you
      "data" # Where I will load that data kept locally that was either downloaded in "dataDL" or created locally
)
```

## stylesreference_docx

`stylesreference_docx` is a document style reference guide is essentially a word document where you have defined each style. Either use a local document (insert "path") or some of the pre-made templates ("refdoc_NOAATechMemo" or "refdoc_FisheriesEconomicsOfTheUS"). Default = "NOAATechMemo"

Here's what they look like: 

### refdoc_noaa_tech_memo

![refdoc_noaa_tech_memo](../man/figures/NOAATechMemo.JPG)

### refdoc_fisheries_economics_of_the_us

![refdoc_fisheries_economics_of_the_us](../man/figures/FisheriesEconomicsOfTheUS.JPG)

## csl

`csl` is a citation style. Either use a local document (insert "path") or some of the pre-made templates ("apa"). Default = "apa" because it was easy to find. 

```{r}
csl = "apa"

# it looks something like this:
apa <- base::readLines(system.file("cit","apa.csl", package="NMFSReports"))
head(apa)
```

# Create Report Outline

Now, magic! Now for the sake of the vignette, I can't actually run it here, but below is a picture of what this looks like:

```{r, eval = FALSE}
NMFSReports::buildTM(
  sections,
  support_scripts,
  authors = "Me, myself, and I",
  title = "My amazing report!", 
  stylesreference_pptx = "refppt_nmfs", 
  stylesreference_docx = "refdoc_noaa_tech_memo", 
  bibliography.bib = "bib_example",
  
  csl
)
```

![buildTM() output](../man/figures/buildTM.JPG)








